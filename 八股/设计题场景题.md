设计题场景题

设计一个秒杀系统。假设有单一商品，库存有限，需要应对10万QPS的瞬时流量

全国 13 亿人口信息的存储与查询该如何设计？

大量数据下缓存怎么做？

**当前服务器CPU负载较高，通过什么命令查看进程的执行状态？哪一个进程占用的资源多？**

我的电脑又是会很卡，此时我会先通过uptime来查看总体负载情况，看 load average>cpu一般就是cpu压力比较大了；然后我会通过htop来查看进程占用内存状态

htop细节：mem:当前物理内存使用情况，但是这个一般不太准确，因为系统会利用空闲内存作为缓存来加速文件访问；所以一般看内存是否够用一般看得是avaliable,他代表的是实际可用内存；然后要是swap此时也高，那就说明内存不足；然后我会通过top找出占用内存空间最高的进程，可以的话就将他杀死

`%CPU`：每个进程的 CPU 使用率

`%MEM`：内存使用率

`RES`、`VIRT`：物理/虚拟内存使用

`Mem`、`Swap`：系统总内存和交换区状态

**1w和1000w数据量的表中，插入一条数据的成本是不是一样的**

要是都是插到最后一行的话，理论上来说应该是o(1)操作，应该差不多，但是对于大数据的插入可能会慢一点，主要可以考虑存储引擎的区别，要是是b+树的话，插入的时候需要在书中寻找插入的位置，那么就与树的高度log(n)有关，那么数据量大的会慢，要是时将数据存入到hash中的，那么数据大的可能产生的冲突就相对较多，那么肯哪个会慢一些；在大树举例，很肯哪个存在页满了的情况，那么还需要分裂页，会层加i/o,效标的话可能都在内存中，还没有进行罗盘，那么进行插入就会相对较块一些

 业务场景：网购平台下单，如何防止超卖和重复？这个架构可能会遇到什么问题，如何解决

我现在有一个接口API返回的要将一个Int64类型的数据返回成String，需要注意什么？

 你对2PC、3PC、TCC模式的理解是什么？

**如何确定一个服务器能够连接多少TCP，需要考量什么**

首先每个tcp连接在内核里面就是一个socket,本质上就是一个文件描述符，在内核中通常默认一个进程能又的文件描述符数量时1024；

然后就是内存消耗，每个tcp连接都会分配发送缓存区和接收缓存区【几kb-mb】，因此可能态多会将内存占满

然后就是四元组限制，要是服务端作为客户端发起连接，端口数由县，我记得好像是65535个

然后就是每个tcp的连接都要维护他的tcp状态，大量连接时。cpu处理可能有限

**两亿qq好去重怎么做？**

假设qq号最大是10位，可以用位图的思想来实现，两亿个qq号，首先将他变成数字，然后读取每个qq号，将qq号先转化成数字，然后检查低num位的值，要是是0就将他变为1,也就是进行标记已经存在，要是已经为1,那就代表已经重复，那就可以直接丢弃，最后输出结果，收集所有位数位1的qq号，就是去重的结果





























 select a from xxx where c > 1 and d != 2 and b = 3，建立索引，怎么建，能最高效