湖南本爱具足智能科技

##### tcp/ip协议栈

tcp/ip协议栈分为4层：从上到下是：应用层，传输层，网络层，链路层

应用层：就是我们直接接触到的应用协议，比如http/https

传输层：实现端到端的通信，比如tcp/udp

网络层：解决新值和路由的问题，比如ip

链路层：负责同一链路上传输数据，比如以太网，wifi等

应用层调用 send() 到内核 TCP/IP 协议栈发送数据全过程

当用户态调用send/write函数，这属于系统调用会先入内核，进入内核socket层，在socket层，内核会检查socket类型以及socket是否已经连接，发送的数据在缓冲区是否有空间，然后检查完毕就进入了tcp协议层，tcp会将数据根据mss大写分割成报文段，在数据前面加上tcp首部，比如说源端口，目的端后，序号，确认号等等，然后将数据放入发送缓冲区，然后就到了ip层，ip层给每个数据包前面都加上ip首部，然后到了链路层，封装以太网帧，然后调用网卡驱动的dma,把数据放到往卡的发送队列，然后网卡从队列取出数据，发送无线电波，对端网卡收帧，然后在层层上交

##### tcp中序列号和应答号的理解

首先就是tcp是面向字节流的，那么他就可能有乱序问题，为了解决这个问题，发送的数据就会进行编号。序列号是对字节流里的每个字节编号，比喻应用层发了1000个字节，tcp会给每个数据包的第一个字节一个序号，后面一次递增。这样就算底层分片乱序到达，接收方有恩哪个按扎序列号进行重组。

确认号是接收方在ack里面带的一个字段，表示的是下一个期望收到的字节序号，比如确认号是501,那么就说明1-500字节都收到了，接下来要从501开始

